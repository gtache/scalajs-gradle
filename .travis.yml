language: scala
jdk:
    - oraclejdk8
scala:
    - 2.12.7
before_install:
    - sudo apt-get -qq update
    
jsenv:
    phantom
    rhino
optim:
    NoOpt
    Fast
    Full
script: 
    - cd ./scalajs-plugin/
    - chmod +x gradlew
    - ./gradlew install
    - travis_wait 30 ./gradlew build
    - cd ../scalajs-plugin-test/
    - chmod +x gradlew

    - ./gradlew RunJS -Pclassname="com.github.gtache.DummyObject" -Pmethname="printSomething(\"blabla\")" -P${jsenv}
    - ./gradlew RunJS -Pclassname="com.github.gtache.DummyScalaTag" -P${jsenv}
    - ./gradlew clean
    - ./gradlew RunJS -PtoExec="com.github.gtache.DummyScalaTag().main()" -Prun${optim} -P${jsenv}
    - ./gradlew clean
    - ./gradlew RunJS -PtoExec="com.github.gtache.DummyObject().main()" -Pclassname="com.github.gtache.DummyScalaTag" -P${jsenv}
    - ./gradlew clean
    - ./gradlew RunJS -PfileToExec="testjs/testRunWithFile.js" -Prun${optim} -P${jsenv}
    - ./gradlew RunJS -PfileToExec="testjs/testRunWithFile.js"
    - ./gradlew TestJS
    - ./gradlew TestJS -Ptest-only='*JUnit*'
    - ./gradlew TestJS -Ptest-only='*Scala*' -P${jsenv}
    - ./gradlew TestJS -Pretest -P${jsenv}
    - ./gradlew TestJS -Ptest-quick='*Scala*' -P${jsenv}


before_cache:
    - rm -f $HOME/.gradle/caches/modules-2/modules-2.lock
cache:
  directories:
    - $HOME/.gradle/caches/
    - $HOME/.gradle/wrapper/